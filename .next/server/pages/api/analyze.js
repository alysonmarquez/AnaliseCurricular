"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/analyze";
exports.ids = ["pages/api/analyze"];
exports.modules = {

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("formidable");

/***/ }),

/***/ "mammoth":
/*!**************************!*\
  !*** external "mammoth" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mammoth");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "pdf-parse":
/*!****************************!*\
  !*** external "pdf-parse" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("pdf-parse");

/***/ }),

/***/ "@google/generative-ai":
/*!****************************************!*\
  !*** external "@google/generative-ai" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("@google/generative-ai");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalyze&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Canalyze.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalyze&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Canalyze.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_analyze_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\analyze.js */ \"(api)/./pages/api/analyze.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_analyze_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_analyze_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_analyze_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_analyze_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/analyze\",\n        pathname: \"/api/analyze\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_analyze_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmFuYWx5emUmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2FuYWx5emUuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDcUQ7QUFDckQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLGtEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxrREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hbmFsaXNhZG9yLWN1cnJpY3Vsb3MvP2MzYTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxhbmFseXplLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYW5hbHl6ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FuYWx5emVcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalyze&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Canalyze.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/analyze.js":
/*!******************************!*\
  !*** ./pages/api/analyze.js ***!
  \******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(formidable__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pdf-parse */ \"pdf-parse\");\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pdf_parse__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var mammoth__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! mammoth */ \"mammoth\");\n/* harmony import */ var mammoth__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(mammoth__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @google/generative-ai */ \"@google/generative-ai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_google_generative_ai__WEBPACK_IMPORTED_MODULE_5__]);\n_google_generative_ai__WEBPACK_IMPORTED_MODULE_5__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\nlet cachedModelName = null;\n// Fun√ß√£o para carregar GEMINI_API_KEY do .env.local de forma garantida\nfunction loadGeminiApiKey() {\n    // Se j√° est√° carregado, retornar\n    if (process.env.GEMINI_API_KEY && process.env.GEMINI_API_KEY.trim().length > 0) {\n        return process.env.GEMINI_API_KEY.trim();\n    }\n    try {\n        const envPath = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \".env.local\");\n        if (!fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(envPath)) {\n            console.error(\"‚ùå .env.local n\\xe3o encontrado em:\", envPath);\n            return null;\n        }\n        // Ler arquivo e remover BOM se houver\n        let content = fs__WEBPACK_IMPORTED_MODULE_1___default().readFileSync(envPath, \"utf8\");\n        if (content.charCodeAt(0) === 0xFEFF) {\n            content = content.substring(1); // Remove UTF-8 BOM\n        }\n        console.log(\"\\uD83D\\uDCC4 Conte\\xfado lido (primeiros 60 chars):\", content.substring(0, 60));\n        console.log(\"\\uD83D\\uDCC4 Tamanho:\", content.length);\n        // M√©todo mais simples: dividir por linhas e procurar\n        const lines = content.split(/\\r?\\n/);\n        console.log(\"\\uD83D\\uDCC4 N\\xfamero de linhas:\", lines.length);\n        for(let i = 0; i < lines.length; i++){\n            const line = lines[i].trim();\n            console.log(`üìÑ Linha ${i}:`, line.substring(0, 50));\n            if (line && line.startsWith(\"GEMINI_API_KEY=\")) {\n                const value = line.substring(\"GEMINI_API_KEY=\".length).trim();\n                console.log(`‚úÖ Chave encontrada na linha ${i}!`);\n                console.log(`‚úÖ Valor (primeiros 20 chars):`, value.substring(0, 20));\n                if (value && value.length > 0) {\n                    const cleanValue = value.replace(/^[\"']|[\"']$/g, \"\").trim();\n                    process.env.GEMINI_API_KEY = cleanValue;\n                    console.log(\"‚úÖ GEMINI_API_KEY definida! Tamanho:\", cleanValue.length);\n                    console.log(\"‚úÖ Preview:\", cleanValue.substring(0, 15) + \"...\");\n                    return cleanValue;\n                }\n            }\n        }\n        console.error(\"‚ùå GEMINI_API_KEY n\\xe3o encontrada no arquivo\");\n        console.error(\"‚ùå Todas as linhas:\", lines.map((l, i)=>`Linha ${i}: ${l.substring(0, 50)}`));\n        return null;\n    } catch (error) {\n        console.error(\"‚ùå Erro ao carregar .env.local:\", error.message);\n        return null;\n    }\n}\nasync function resolveModelName(apiKey) {\n    if (process.env.GEMINI_MODEL && process.env.GEMINI_MODEL.trim().length > 0) {\n        return process.env.GEMINI_MODEL.trim();\n    }\n    if (cachedModelName) {\n        return cachedModelName;\n    }\n    try {\n        // Fazer requisi√ß√£o direta √† API v1 (n√£o v1beta) para listar modelos\n        const response = await fetch(`https://generativelanguage.googleapis.com/v1/models?key=${apiKey}`);\n        const data = await response.json();\n        if (!response.ok) {\n            throw new Error(`Erro ao listar modelos: ${data.error?.message || response.statusText}`);\n        }\n        const models = data.models || [];\n        const supported = models.filter((model)=>(model.supportedGenerationMethods || []).includes(\"generateContent\")).map((model)=>model.name);\n        console.log(\"\\uD83D\\uDCCB Modelos dispon\\xedveis na API v1:\", supported);\n        // Priorizar modelos mais recentes que funcionam na API v1\n        const preferred = supported.find((name)=>name.includes(\"2.0\")) || supported.find((name)=>name.includes(\"1.5-flash\")) || supported.find((name)=>name.includes(\"1.5-pro\")) || supported[0];\n        if (preferred) {\n            const normalized = preferred.replace(/^models\\//, \"\");\n            cachedModelName = normalized;\n            console.log(\"‚úÖ Modelo selecionado automaticamente:\", normalized);\n            return normalized;\n        }\n    } catch (error) {\n        console.error(\"‚ùå Falha ao listar modelos da API v1:\", error.message);\n    }\n    // Fallback para modelos que funcionam na API v1\n    console.warn(\"‚ö†Ô∏è Usando fallback de modelo gemini-1.5-flash\");\n    return \"gemini-1.5-flash\";\n}\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"M\\xe9todo n\\xe3o permitido\"\n        });\n    }\n    // Carregar a API key de forma garantida\n    const apiKey = loadGeminiApiKey();\n    if (!apiKey || apiKey.length === 0) {\n        console.error(\"‚ùå GEMINI_API_KEY n\\xe3o p\\xf4de ser carregada\");\n        return res.status(500).json({\n            error: \"Configura\\xe7\\xe3o do servidor incompleta. Contate o administrador.\"\n        });\n    }\n    console.log(\"‚úÖ API Key carregada com sucesso (tamanho:\", apiKey.length + \")\");\n    let data = null;\n    try {\n        // Parse do arquivo usando formidable\n        data = await new Promise((resolve, reject)=>{\n            const form = formidable__WEBPACK_IMPORTED_MODULE_0___default()({\n                multiples: false,\n                keepExtensions: true,\n                maxFileSize: 10 * 1024 * 1024\n            });\n            form.parse(req, (err, fields, files)=>{\n                if (err) {\n                    console.error(\"Erro ao fazer parse do formul\\xe1rio:\", err);\n                    reject(err);\n                    return;\n                }\n                resolve({\n                    fields,\n                    files\n                });\n            });\n        });\n        // Tratar o arquivo (pode ser array ou objeto √∫nico)\n        let file = data.files.file;\n        if (Array.isArray(file)) {\n            file = file[0];\n        }\n        if (!file) {\n            return res.status(400).json({\n                error: \"Nenhum arquivo enviado.\"\n            });\n        }\n        // Leitura do arquivo\n        if (!file.filepath) {\n            console.error(\"Arquivo sem filepath:\", file);\n            return res.status(400).json({\n                error: \"Erro ao processar arquivo. Tente novamente.\"\n            });\n        }\n        const fileBuffer = fs__WEBPACK_IMPORTED_MODULE_1___default().readFileSync(file.filepath);\n        let extractedText = \"\";\n        // Detectar tipo de arquivo pelo mimetype ou extens√£o\n        const fileExtension = path__WEBPACK_IMPORTED_MODULE_2___default().extname(file.originalFilename || \"\").toLowerCase();\n        const mimetype = file.mimetype || \"\";\n        if (mimetype === \"application/pdf\" || fileExtension === \".pdf\") {\n            try {\n                const pdfData = await pdf_parse__WEBPACK_IMPORTED_MODULE_3___default()(fileBuffer);\n                extractedText = pdfData.text;\n            } catch (pdfError) {\n                console.error(\"Erro ao ler PDF:\", pdfError);\n                return res.status(400).json({\n                    error: \"Erro ao ler arquivo PDF. Verifique se o arquivo est\\xe1 corrompido.\"\n                });\n            }\n        } else if (mimetype === \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\" || fileExtension === \".docx\") {\n            try {\n                const docxData = await mammoth__WEBPACK_IMPORTED_MODULE_4___default().extractRawText({\n                    buffer: fileBuffer\n                });\n                extractedText = docxData.value;\n            } catch (docxError) {\n                console.error(\"Erro ao ler DOCX:\", docxError);\n                return res.status(400).json({\n                    error: \"Erro ao ler arquivo DOCX. Verifique se o arquivo est\\xe1 corrompido.\"\n                });\n            }\n        } else {\n            return res.status(400).json({\n                error: `Formato n√£o suportado. Use arquivos PDF ou DOCX. Tipo recebido: ${mimetype || fileExtension}`\n            });\n        }\n        if (!extractedText || extractedText.trim().length === 0) {\n            return res.status(400).json({\n                error: \"N\\xe3o foi poss\\xedvel extrair texto do arquivo. Verifique se o arquivo cont\\xe9m texto.\"\n            });\n        }\n        // Inicializando Gemini\n        // A biblioteca @google/generative-ai usa v1beta por padr√£o\n        // Vamos listar modelos da API v1 diretamente e usar um modelo compat√≠vel\n        const genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_5__.GoogleGenerativeAI(apiKey);\n        // Listar modelos dispon√≠veis na API v1 (n√£o v1beta)\n        let modelName = null;\n        try {\n            modelName = await resolveModelName(apiKey);\n            console.log(\"‚úÖ Modelo selecionado da API v1:\", modelName);\n        } catch (error) {\n            console.warn(\"‚ö†Ô∏è Erro ao listar modelos:\", error.message);\n            // Fallback\n            modelName = \"gemini-1.5-flash\";\n            console.log(\"‚ö†Ô∏è Usando modelo fallback:\", modelName);\n        }\n        console.log(\"\\uD83D\\uDD01 Inicializando modelo Gemini:\", modelName);\n        // Criar o modelo\n        // NOTA: A biblioteca pode ainda usar v1beta internamente, mas vamos tentar\n        const model = genAI.getGenerativeModel({\n            model: modelName\n        });\n        const prompt = `\n      Voc√™ √© um especialista em curr√≠culos da √°rea de tecnologia e especialista em ATS.\n      Analise o curr√≠culo fornecido e retorne em t√≥picos:\n\n      - Pontos fracos\n      - O que melhorar\n      - Ajustes para ATS\n      - Sugest√£o de estrutura\n      - Sugest√µes espec√≠ficas para √°rea tech\n\n      Texto extra√≠do do curr√≠culo:\n      ${extractedText}\n    `;\n        // A biblioteca pode estar usando v1beta, ent√£o vamos fazer chamada direta √† API v1\n        let responseText;\n        try {\n            // Tentar usar a biblioteca primeiro\n            const result = await model.generateContent(prompt);\n            responseText = result.response.text();\n        } catch (libraryError) {\n            // Se falhar (provavelmente por usar v1beta), fazer chamada direta √† API v1\n            if (libraryError.message?.includes(\"v1beta\") || libraryError.message?.includes(\"404\")) {\n                console.warn(\"‚ö†Ô∏è Biblioteca usando v1beta, fazendo chamada direta \\xe0 API v1...\");\n                const v1Response = await fetch(`https://generativelanguage.googleapis.com/v1/models/${modelName}:generateContent?key=${apiKey}`, {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        contents: [\n                            {\n                                parts: [\n                                    {\n                                        text: prompt\n                                    }\n                                ]\n                            }\n                        ]\n                    })\n                });\n                if (!v1Response.ok) {\n                    const errorData = await v1Response.json();\n                    throw new Error(`API v1 error: ${errorData.error?.message || v1Response.statusText}`);\n                }\n                const v1Data = await v1Response.json();\n                responseText = v1Data.candidates?.[0]?.content?.parts?.[0]?.text || JSON.stringify(v1Data);\n                console.log(\"‚úÖ Resposta recebida da API v1\");\n            } else {\n                throw libraryError;\n            }\n        }\n        // Limpar arquivo tempor√°rio\n        try {\n            if (file.filepath && fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(file.filepath)) {\n                fs__WEBPACK_IMPORTED_MODULE_1___default().unlinkSync(file.filepath);\n            }\n        } catch (cleanupError) {\n            console.warn(\"Erro ao limpar arquivo tempor\\xe1rio:\", cleanupError);\n        }\n        return res.status(200).json({\n            text: extractedText,\n            analysis: responseText\n        });\n    } catch (error) {\n        console.error(\"Erro ao processar:\", error);\n        console.error(\"Stack trace:\", error.stack);\n        // Limpar arquivo tempor√°rio em caso de erro (se data foi definido)\n        try {\n            if (data?.files?.file) {\n                let file = data.files.file;\n                if (Array.isArray(file)) file = file[0];\n                if (file?.filepath && fs__WEBPACK_IMPORTED_MODULE_1___default().existsSync(file.filepath)) {\n                    fs__WEBPACK_IMPORTED_MODULE_1___default().unlinkSync(file.filepath);\n                }\n            }\n        } catch (cleanupError) {\n            console.warn(\"Erro ao limpar arquivo tempor\\xe1rio:\", cleanupError);\n        }\n        // Mensagens de erro mais espec√≠ficas\n        if (error.message?.includes(\"leaked\") || error.message?.includes(\"reportada como vazada\")) {\n            return res.status(500).json({\n                error: \"Sua chave API foi reportada como vazada. Por favor, gere uma nova chave API no Google AI Studio e atualize o arquivo .env.local\"\n            });\n        }\n        if (error.message?.includes(\"API key\") || error.message?.includes(\"GEMINI\") || error.message?.includes(\"401\") || error.message?.includes(\"403\")) {\n            return res.status(500).json({\n                error: \"Erro de autentica\\xe7\\xe3o com a API. Verifique as configura\\xe7\\xf5es.\"\n            });\n        }\n        return res.status(500).json({\n            error: error.message || \"Erro ao analisar curr\\xedculo. Tente novamente mais tarde.\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU0sQ0FBQyxLQUFLdEIsSUFBSSxDQUFDO1lBQzFCdkIsT0FBT0EsTUFBTWdCLE9BQU8sSUFBSTtRQUMxQjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hbmFsaXNhZG9yLWN1cnJpY3Vsb3MvLi9wYWdlcy9hcGkvYW5hbHl6ZS5qcz9kMmJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBmb3JtaWRhYmxlIGZyb20gXCJmb3JtaWRhYmxlXCI7XG5pbXBvcnQgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IHBkZiBmcm9tIFwicGRmLXBhcnNlXCI7XG5pbXBvcnQgbWFtbW90aCBmcm9tIFwibWFtbW90aFwiO1xuaW1wb3J0IHsgR29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSBcIkBnb29nbGUvZ2VuZXJhdGl2ZS1haVwiO1xuXG5sZXQgY2FjaGVkTW9kZWxOYW1lID0gbnVsbDtcblxuLy8gRnVuw6fDo28gcGFyYSBjYXJyZWdhciBHRU1JTklfQVBJX0tFWSBkbyAuZW52LmxvY2FsIGRlIGZvcm1hIGdhcmFudGlkYVxuZnVuY3Rpb24gbG9hZEdlbWluaUFwaUtleSgpIHtcbiAgLy8gU2UgasOhIGVzdMOhIGNhcnJlZ2FkbywgcmV0b3JuYXJcbiAgaWYgKHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZICYmIHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZLnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIHByb2Nlc3MuZW52LkdFTUlOSV9BUElfS0VZLnRyaW0oKTtcbiAgfVxuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBlbnZQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICcuZW52LmxvY2FsJyk7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGVudlBhdGgpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIC5lbnYubG9jYWwgbsOjbyBlbmNvbnRyYWRvIGVtOlwiLCBlbnZQYXRoKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBcbiAgICAvLyBMZXIgYXJxdWl2byBlIHJlbW92ZXIgQk9NIHNlIGhvdXZlclxuICAgIGxldCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGVudlBhdGgsICd1dGY4Jyk7XG4gICAgaWYgKGNvbnRlbnQuY2hhckNvZGVBdCgwKSA9PT0gMHhGRUZGKSB7XG4gICAgICBjb250ZW50ID0gY29udGVudC5zdWJzdHJpbmcoMSk7IC8vIFJlbW92ZSBVVEYtOCBCT01cbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coXCLwn5OEIENvbnRlw7pkbyBsaWRvIChwcmltZWlyb3MgNjAgY2hhcnMpOlwiLCBjb250ZW50LnN1YnN0cmluZygwLCA2MCkpO1xuICAgIGNvbnNvbGUubG9nKFwi8J+ThCBUYW1hbmhvOlwiLCBjb250ZW50Lmxlbmd0aCk7XG4gICAgXG4gICAgLy8gTcOpdG9kbyBtYWlzIHNpbXBsZXM6IGRpdmlkaXIgcG9yIGxpbmhhcyBlIHByb2N1cmFyXG4gICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KC9cXHI/XFxuLyk7XG4gICAgY29uc29sZS5sb2coXCLwn5OEIE7Dum1lcm8gZGUgbGluaGFzOlwiLCBsaW5lcy5sZW5ndGgpO1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKCk7XG4gICAgICBjb25zb2xlLmxvZyhg8J+ThCBMaW5oYSAke2l9OmAsIGxpbmUuc3Vic3RyaW5nKDAsIDUwKSk7XG4gICAgICBcbiAgICAgIGlmIChsaW5lICYmIGxpbmUuc3RhcnRzV2l0aCgnR0VNSU5JX0FQSV9LRVk9JykpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBsaW5lLnN1YnN0cmluZygnR0VNSU5JX0FQSV9LRVk9Jy5sZW5ndGgpLnRyaW0oKTtcbiAgICAgICAgY29uc29sZS5sb2coYOKchSBDaGF2ZSBlbmNvbnRyYWRhIG5hIGxpbmhhICR7aX0hYCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGDinIUgVmFsb3IgKHByaW1laXJvcyAyMCBjaGFycyk6YCwgdmFsdWUuc3Vic3RyaW5nKDAsIDIwKSk7XG4gICAgICAgIFxuICAgICAgICBpZiAodmFsdWUgJiYgdmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGNsZWFuVmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9eW1wiJ118W1wiJ10kL2csICcnKS50cmltKCk7XG4gICAgICAgICAgcHJvY2Vzcy5lbnYuR0VNSU5JX0FQSV9LRVkgPSBjbGVhblZhbHVlO1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIEdFTUlOSV9BUElfS0VZIGRlZmluaWRhISBUYW1hbmhvOlwiLCBjbGVhblZhbHVlLmxlbmd0aCk7XG4gICAgICAgICAgY29uc29sZS5sb2coXCLinIUgUHJldmlldzpcIiwgY2xlYW5WYWx1ZS5zdWJzdHJpbmcoMCwgMTUpICsgXCIuLi5cIik7XG4gICAgICAgICAgcmV0dXJuIGNsZWFuVmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBHRU1JTklfQVBJX0tFWSBuw6NvIGVuY29udHJhZGEgbm8gYXJxdWl2b1wiKTtcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIFRvZGFzIGFzIGxpbmhhczpcIiwgbGluZXMubWFwKChsLCBpKSA9PiBgTGluaGEgJHtpfTogJHtsLnN1YnN0cmluZygwLCA1MCl9YCkpO1xuICAgIHJldHVybiBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRXJybyBhbyBjYXJyZWdhciAuZW52LmxvY2FsOlwiLCBlcnJvci5tZXNzYWdlKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiByZXNvbHZlTW9kZWxOYW1lKGFwaUtleSkge1xuICBpZiAocHJvY2Vzcy5lbnYuR0VNSU5JX01PREVMICYmIHByb2Nlc3MuZW52LkdFTUlOSV9NT0RFTC50cmltKCkubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBwcm9jZXNzLmVudi5HRU1JTklfTU9ERUwudHJpbSgpO1xuICB9XG5cbiAgaWYgKGNhY2hlZE1vZGVsTmFtZSkge1xuICAgIHJldHVybiBjYWNoZWRNb2RlbE5hbWU7XG4gIH1cblxuICB0cnkge1xuICAgIC8vIEZhemVyIHJlcXVpc2nDp8OjbyBkaXJldGEgw6AgQVBJIHYxIChuw6NvIHYxYmV0YSkgcGFyYSBsaXN0YXIgbW9kZWxvc1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxL21vZGVscz9rZXk9JHthcGlLZXl9YCk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICBcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm8gYW8gbGlzdGFyIG1vZGVsb3M6ICR7ZGF0YS5lcnJvcj8ubWVzc2FnZSB8fCByZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBtb2RlbHMgPSBkYXRhLm1vZGVscyB8fCBbXTtcbiAgICBjb25zdCBzdXBwb3J0ZWQgPSBtb2RlbHNcbiAgICAgIC5maWx0ZXIoKG1vZGVsKSA9PlxuICAgICAgICAobW9kZWwuc3VwcG9ydGVkR2VuZXJhdGlvbk1ldGhvZHMgfHwgW10pLmluY2x1ZGVzKFwiZ2VuZXJhdGVDb250ZW50XCIpXG4gICAgICApXG4gICAgICAubWFwKChtb2RlbCkgPT4gbW9kZWwubmFtZSk7XG5cbiAgICBjb25zb2xlLmxvZyhcIvCfk4sgTW9kZWxvcyBkaXNwb27DrXZlaXMgbmEgQVBJIHYxOlwiLCBzdXBwb3J0ZWQpO1xuXG4gICAgLy8gUHJpb3JpemFyIG1vZGVsb3MgbWFpcyByZWNlbnRlcyBxdWUgZnVuY2lvbmFtIG5hIEFQSSB2MVxuICAgIGNvbnN0IHByZWZlcnJlZCA9XG4gICAgICBzdXBwb3J0ZWQuZmluZCgobmFtZSkgPT4gbmFtZS5pbmNsdWRlcyhcIjIuMFwiKSkgfHxcbiAgICAgIHN1cHBvcnRlZC5maW5kKChuYW1lKSA9PiBuYW1lLmluY2x1ZGVzKFwiMS41LWZsYXNoXCIpKSB8fFxuICAgICAgc3VwcG9ydGVkLmZpbmQoKG5hbWUpID0+IG5hbWUuaW5jbHVkZXMoXCIxLjUtcHJvXCIpKSB8fFxuICAgICAgc3VwcG9ydGVkWzBdO1xuXG4gICAgaWYgKHByZWZlcnJlZCkge1xuICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IHByZWZlcnJlZC5yZXBsYWNlKC9ebW9kZWxzXFwvLywgXCJcIik7XG4gICAgICBjYWNoZWRNb2RlbE5hbWUgPSBub3JtYWxpemVkO1xuICAgICAgY29uc29sZS5sb2coXCLinIUgTW9kZWxvIHNlbGVjaW9uYWRvIGF1dG9tYXRpY2FtZW50ZTpcIiwgbm9ybWFsaXplZCk7XG4gICAgICByZXR1cm4gbm9ybWFsaXplZDtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBGYWxoYSBhbyBsaXN0YXIgbW9kZWxvcyBkYSBBUEkgdjE6XCIsIGVycm9yLm1lc3NhZ2UpO1xuICB9XG5cbiAgLy8gRmFsbGJhY2sgcGFyYSBtb2RlbG9zIHF1ZSBmdW5jaW9uYW0gbmEgQVBJIHYxXG4gIGNvbnNvbGUud2FybihcIuKaoO+4jyBVc2FuZG8gZmFsbGJhY2sgZGUgbW9kZWxvIGdlbWluaS0xLjUtZmxhc2hcIik7XG4gIHJldHVybiBcImdlbWluaS0xLjUtZmxhc2hcIjtcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgYXBpOiB7XG4gICAgYm9keVBhcnNlcjogZmFsc2UsIC8vIG5lY2Vzc8OhcmlvIHBhcmEgcmVjZWJlciBhcnF1aXZvcyBubyBOZXh0IDE0XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSBcIlBPU1RcIikge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiBcIk3DqXRvZG8gbsOjbyBwZXJtaXRpZG9cIiB9KTtcbiAgfVxuXG4gIC8vIENhcnJlZ2FyIGEgQVBJIGtleSBkZSBmb3JtYSBnYXJhbnRpZGFcbiAgY29uc3QgYXBpS2V5ID0gbG9hZEdlbWluaUFwaUtleSgpO1xuICBcbiAgaWYgKCFhcGlLZXkgfHwgYXBpS2V5Lmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgR0VNSU5JX0FQSV9LRVkgbsOjbyBww7RkZSBzZXIgY2FycmVnYWRhXCIpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBcIkNvbmZpZ3VyYcOnw6NvIGRvIHNlcnZpZG9yIGluY29tcGxldGEuIENvbnRhdGUgbyBhZG1pbmlzdHJhZG9yLlwiIH0pO1xuICB9XG4gIFxuICBjb25zb2xlLmxvZyhcIuKchSBBUEkgS2V5IGNhcnJlZ2FkYSBjb20gc3VjZXNzbyAodGFtYW5obzpcIiwgYXBpS2V5Lmxlbmd0aCArIFwiKVwiKTtcblxuICBsZXQgZGF0YSA9IG51bGw7XG4gIHRyeSB7XG4gICAgLy8gUGFyc2UgZG8gYXJxdWl2byB1c2FuZG8gZm9ybWlkYWJsZVxuICAgIGRhdGEgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBmb3JtID0gZm9ybWlkYWJsZSh7XG4gICAgICAgIG11bHRpcGxlczogZmFsc2UsXG4gICAgICAgIGtlZXBFeHRlbnNpb25zOiB0cnVlLFxuICAgICAgICBtYXhGaWxlU2l6ZTogMTAgKiAxMDI0ICogMTAyNCwgLy8gMTBNQlxuICAgICAgfSk7XG5cbiAgICAgIGZvcm0ucGFyc2UocmVxLCAoZXJyLCBmaWVsZHMsIGZpbGVzKSA9PiB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJybyBhbyBmYXplciBwYXJzZSBkbyBmb3JtdWzDoXJpbzpcIiwgZXJyKTtcbiAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgcmVzb2x2ZSh7IGZpZWxkcywgZmlsZXMgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIFRyYXRhciBvIGFycXVpdm8gKHBvZGUgc2VyIGFycmF5IG91IG9iamV0byDDum5pY28pXG4gICAgbGV0IGZpbGUgPSBkYXRhLmZpbGVzLmZpbGU7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoZmlsZSkpIHtcbiAgICAgIGZpbGUgPSBmaWxlWzBdO1xuICAgIH1cblxuICAgIGlmICghZmlsZSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6IFwiTmVuaHVtIGFycXVpdm8gZW52aWFkby5cIiB9KTtcbiAgICB9XG5cbiAgICAvLyBMZWl0dXJhIGRvIGFycXVpdm9cbiAgICBpZiAoIWZpbGUuZmlsZXBhdGgpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJBcnF1aXZvIHNlbSBmaWxlcGF0aDpcIiwgZmlsZSk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogXCJFcnJvIGFvIHByb2Nlc3NhciBhcnF1aXZvLiBUZW50ZSBub3ZhbWVudGUuXCIgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgZmlsZUJ1ZmZlciA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLmZpbGVwYXRoKTtcbiAgICBsZXQgZXh0cmFjdGVkVGV4dCA9IFwiXCI7XG5cbiAgICAvLyBEZXRlY3RhciB0aXBvIGRlIGFycXVpdm8gcGVsbyBtaW1ldHlwZSBvdSBleHRlbnPDo29cbiAgICBjb25zdCBmaWxlRXh0ZW5zaW9uID0gcGF0aC5leHRuYW1lKGZpbGUub3JpZ2luYWxGaWxlbmFtZSB8fCBcIlwiKS50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IG1pbWV0eXBlID0gZmlsZS5taW1ldHlwZSB8fCBcIlwiO1xuXG4gICAgaWYgKG1pbWV0eXBlID09PSBcImFwcGxpY2F0aW9uL3BkZlwiIHx8IGZpbGVFeHRlbnNpb24gPT09IFwiLnBkZlwiKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBwZGZEYXRhID0gYXdhaXQgcGRmKGZpbGVCdWZmZXIpO1xuICAgICAgICBleHRyYWN0ZWRUZXh0ID0gcGRmRGF0YS50ZXh0O1xuICAgICAgfSBjYXRjaCAocGRmRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm8gYW8gbGVyIFBERjpcIiwgcGRmRXJyb3IpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogXCJFcnJvIGFvIGxlciBhcnF1aXZvIFBERi4gVmVyaWZpcXVlIHNlIG8gYXJxdWl2byBlc3TDoSBjb3Jyb21waWRvLlwiIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoXG4gICAgICBtaW1ldHlwZSA9PT0gXCJhcHBsaWNhdGlvbi92bmQub3BlbnhtbGZvcm1hdHMtb2ZmaWNlZG9jdW1lbnQud29yZHByb2Nlc3NpbmdtbC5kb2N1bWVudFwiIHx8XG4gICAgICBmaWxlRXh0ZW5zaW9uID09PSBcIi5kb2N4XCJcbiAgICApIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRvY3hEYXRhID0gYXdhaXQgbWFtbW90aC5leHRyYWN0UmF3VGV4dCh7IGJ1ZmZlcjogZmlsZUJ1ZmZlciB9KTtcbiAgICAgICAgZXh0cmFjdGVkVGV4dCA9IGRvY3hEYXRhLnZhbHVlO1xuICAgICAgfSBjYXRjaCAoZG9jeEVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvIGFvIGxlciBET0NYOlwiLCBkb2N4RXJyb3IpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogXCJFcnJvIGFvIGxlciBhcnF1aXZvIERPQ1guIFZlcmlmaXF1ZSBzZSBvIGFycXVpdm8gZXN0w6EgY29ycm9tcGlkby5cIiB9KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICAgIGVycm9yOiBgRm9ybWF0byBuw6NvIHN1cG9ydGFkby4gVXNlIGFycXVpdm9zIFBERiBvdSBET0NYLiBUaXBvIHJlY2ViaWRvOiAke21pbWV0eXBlIHx8IGZpbGVFeHRlbnNpb259YCBcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICghZXh0cmFjdGVkVGV4dCB8fCBleHRyYWN0ZWRUZXh0LnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBcIk7Do28gZm9pIHBvc3PDrXZlbCBleHRyYWlyIHRleHRvIGRvIGFycXVpdm8uIFZlcmlmaXF1ZSBzZSBvIGFycXVpdm8gY29udMOpbSB0ZXh0by5cIiB9KTtcbiAgICB9XG5cbiAgICAvLyBJbmljaWFsaXphbmRvIEdlbWluaVxuICAgIC8vIEEgYmlibGlvdGVjYSBAZ29vZ2xlL2dlbmVyYXRpdmUtYWkgdXNhIHYxYmV0YSBwb3IgcGFkcsOjb1xuICAgIC8vIFZhbW9zIGxpc3RhciBtb2RlbG9zIGRhIEFQSSB2MSBkaXJldGFtZW50ZSBlIHVzYXIgdW0gbW9kZWxvIGNvbXBhdMOtdmVsXG4gICAgY29uc3QgZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKGFwaUtleSk7XG4gICAgXG4gICAgLy8gTGlzdGFyIG1vZGVsb3MgZGlzcG9uw612ZWlzIG5hIEFQSSB2MSAobsOjbyB2MWJldGEpXG4gICAgbGV0IG1vZGVsTmFtZSA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIG1vZGVsTmFtZSA9IGF3YWl0IHJlc29sdmVNb2RlbE5hbWUoYXBpS2V5KTtcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIE1vZGVsbyBzZWxlY2lvbmFkbyBkYSBBUEkgdjE6XCIsIG1vZGVsTmFtZSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybihcIuKaoO+4jyBFcnJvIGFvIGxpc3RhciBtb2RlbG9zOlwiLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgIC8vIEZhbGxiYWNrXG4gICAgICBtb2RlbE5hbWUgPSBcImdlbWluaS0xLjUtZmxhc2hcIjtcbiAgICAgIGNvbnNvbGUubG9nKFwi4pqg77iPIFVzYW5kbyBtb2RlbG8gZmFsbGJhY2s6XCIsIG1vZGVsTmFtZSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKFwi8J+UgSBJbmljaWFsaXphbmRvIG1vZGVsbyBHZW1pbmk6XCIsIG1vZGVsTmFtZSk7XG4gICAgXG4gICAgLy8gQ3JpYXIgbyBtb2RlbG9cbiAgICAvLyBOT1RBOiBBIGJpYmxpb3RlY2EgcG9kZSBhaW5kYSB1c2FyIHYxYmV0YSBpbnRlcm5hbWVudGUsIG1hcyB2YW1vcyB0ZW50YXJcbiAgICBjb25zdCBtb2RlbCA9IGdlbkFJLmdldEdlbmVyYXRpdmVNb2RlbCh7IG1vZGVsOiBtb2RlbE5hbWUgfSk7XG5cbiAgICBjb25zdCBwcm9tcHQgPSBgXG4gICAgICBWb2PDqiDDqSB1bSBlc3BlY2lhbGlzdGEgZW0gY3VycsOtY3Vsb3MgZGEgw6FyZWEgZGUgdGVjbm9sb2dpYSBlIGVzcGVjaWFsaXN0YSBlbSBBVFMuXG4gICAgICBBbmFsaXNlIG8gY3VycsOtY3VsbyBmb3JuZWNpZG8gZSByZXRvcm5lIGVtIHTDs3BpY29zOlxuXG4gICAgICAtIFBvbnRvcyBmcmFjb3NcbiAgICAgIC0gTyBxdWUgbWVsaG9yYXJcbiAgICAgIC0gQWp1c3RlcyBwYXJhIEFUU1xuICAgICAgLSBTdWdlc3TDo28gZGUgZXN0cnV0dXJhXG4gICAgICAtIFN1Z2VzdMO1ZXMgZXNwZWPDrWZpY2FzIHBhcmEgw6FyZWEgdGVjaFxuXG4gICAgICBUZXh0byBleHRyYcOtZG8gZG8gY3VycsOtY3VsbzpcbiAgICAgICR7ZXh0cmFjdGVkVGV4dH1cbiAgICBgO1xuXG4gICAgLy8gQSBiaWJsaW90ZWNhIHBvZGUgZXN0YXIgdXNhbmRvIHYxYmV0YSwgZW50w6NvIHZhbW9zIGZhemVyIGNoYW1hZGEgZGlyZXRhIMOgIEFQSSB2MVxuICAgIGxldCByZXNwb25zZVRleHQ7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFRlbnRhciB1c2FyIGEgYmlibGlvdGVjYSBwcmltZWlyb1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KHByb21wdCk7XG4gICAgICByZXNwb25zZVRleHQgPSByZXN1bHQucmVzcG9uc2UudGV4dCgpO1xuICAgIH0gY2F0Y2ggKGxpYnJhcnlFcnJvcikge1xuICAgICAgLy8gU2UgZmFsaGFyIChwcm92YXZlbG1lbnRlIHBvciB1c2FyIHYxYmV0YSksIGZhemVyIGNoYW1hZGEgZGlyZXRhIMOgIEFQSSB2MVxuICAgICAgaWYgKGxpYnJhcnlFcnJvci5tZXNzYWdlPy5pbmNsdWRlcyhcInYxYmV0YVwiKSB8fCBsaWJyYXJ5RXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoXCI0MDRcIikpIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIEJpYmxpb3RlY2EgdXNhbmRvIHYxYmV0YSwgZmF6ZW5kbyBjaGFtYWRhIGRpcmV0YSDDoCBBUEkgdjEuLi5cIik7XG4gICAgICAgIFxuICAgICAgICBjb25zdCB2MVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICAgYGh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxL21vZGVscy8ke21vZGVsTmFtZX06Z2VuZXJhdGVDb250ZW50P2tleT0ke2FwaUtleX1gLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgY29udGVudHM6IFt7XG4gICAgICAgICAgICAgICAgcGFydHM6IFt7XG4gICAgICAgICAgICAgICAgICB0ZXh0OiBwcm9tcHRcbiAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXYxUmVzcG9uc2Uub2spIHtcbiAgICAgICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCB2MVJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEFQSSB2MSBlcnJvcjogJHtlcnJvckRhdGEuZXJyb3I/Lm1lc3NhZ2UgfHwgdjFSZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCB2MURhdGEgPSBhd2FpdCB2MVJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgcmVzcG9uc2VUZXh0ID0gdjFEYXRhLmNhbmRpZGF0ZXM/LlswXT8uY29udGVudD8ucGFydHM/LlswXT8udGV4dCB8fCBcbiAgICAgICAgICAgICAgICAgICAgICBKU09OLnN0cmluZ2lmeSh2MURhdGEpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBSZXNwb3N0YSByZWNlYmlkYSBkYSBBUEkgdjFcIik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBsaWJyYXJ5RXJyb3I7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gTGltcGFyIGFycXVpdm8gdGVtcG9yw6FyaW9cbiAgICB0cnkge1xuICAgICAgaWYgKGZpbGUuZmlsZXBhdGggJiYgZnMuZXhpc3RzU3luYyhmaWxlLmZpbGVwYXRoKSkge1xuICAgICAgICBmcy51bmxpbmtTeW5jKGZpbGUuZmlsZXBhdGgpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGNsZWFudXBFcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFwiRXJybyBhbyBsaW1wYXIgYXJxdWl2byB0ZW1wb3LDoXJpbzpcIiwgY2xlYW51cEVycm9yKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgdGV4dDogZXh0cmFjdGVkVGV4dCxcbiAgICAgIGFuYWx5c2lzOiByZXNwb25zZVRleHQsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm8gYW8gcHJvY2Vzc2FyOlwiLCBlcnJvcik7XG4gICAgY29uc29sZS5lcnJvcihcIlN0YWNrIHRyYWNlOlwiLCBlcnJvci5zdGFjayk7XG4gICAgXG4gICAgLy8gTGltcGFyIGFycXVpdm8gdGVtcG9yw6FyaW8gZW0gY2FzbyBkZSBlcnJvIChzZSBkYXRhIGZvaSBkZWZpbmlkbylcbiAgICB0cnkge1xuICAgICAgaWYgKGRhdGE/LmZpbGVzPy5maWxlKSB7XG4gICAgICAgIGxldCBmaWxlID0gZGF0YS5maWxlcy5maWxlO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWxlKSkgZmlsZSA9IGZpbGVbMF07XG4gICAgICAgIGlmIChmaWxlPy5maWxlcGF0aCAmJiBmcy5leGlzdHNTeW5jKGZpbGUuZmlsZXBhdGgpKSB7XG4gICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlLmZpbGVwYXRoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGNsZWFudXBFcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKFwiRXJybyBhbyBsaW1wYXIgYXJxdWl2byB0ZW1wb3LDoXJpbzpcIiwgY2xlYW51cEVycm9yKTtcbiAgICB9XG5cbiAgICAvLyBNZW5zYWdlbnMgZGUgZXJybyBtYWlzIGVzcGVjw61maWNhc1xuICAgIGlmIChlcnJvci5tZXNzYWdlPy5pbmNsdWRlcyhcImxlYWtlZFwiKSB8fCBlcnJvci5tZXNzYWdlPy5pbmNsdWRlcyhcInJlcG9ydGFkYSBjb21vIHZhemFkYVwiKSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICAgIGVycm9yOiBcIlN1YSBjaGF2ZSBBUEkgZm9pIHJlcG9ydGFkYSBjb21vIHZhemFkYS4gUG9yIGZhdm9yLCBnZXJlIHVtYSBub3ZhIGNoYXZlIEFQSSBubyBHb29nbGUgQUkgU3R1ZGlvIGUgYXR1YWxpemUgbyBhcnF1aXZvIC5lbnYubG9jYWxcIiBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICBpZiAoZXJyb3IubWVzc2FnZT8uaW5jbHVkZXMoXCJBUEkga2V5XCIpIHx8IGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKFwiR0VNSU5JXCIpIHx8IGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKFwiNDAxXCIpIHx8IGVycm9yLm1lc3NhZ2U/LmluY2x1ZGVzKFwiNDAzXCIpKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogXCJFcnJvIGRlIGF1dGVudGljYcOnw6NvIGNvbSBhIEFQSS4gVmVyaWZpcXVlIGFzIGNvbmZpZ3VyYcOnw7Vlcy5cIiB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSB8fCBcIkVycm8gYW8gYW5hbGlzYXIgY3VycsOtY3Vsby4gVGVudGUgbm92YW1lbnRlIG1haXMgdGFyZGUuXCIgXG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJmb3JtaWRhYmxlIiwiZnMiLCJwYXRoIiwicGRmIiwibWFtbW90aCIsIkdvb2dsZUdlbmVyYXRpdmVBSSIsImNhY2hlZE1vZGVsTmFtZSIsImxvYWRHZW1pbmlBcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiR0VNSU5JX0FQSV9LRVkiLCJ0cmltIiwibGVuZ3RoIiwiZW52UGF0aCIsImpvaW4iLCJjd2QiLCJleGlzdHNTeW5jIiwiY29uc29sZSIsImVycm9yIiwiY29udGVudCIsInJlYWRGaWxlU3luYyIsImNoYXJDb2RlQXQiLCJzdWJzdHJpbmciLCJsb2ciLCJsaW5lcyIsInNwbGl0IiwiaSIsImxpbmUiLCJzdGFydHNXaXRoIiwidmFsdWUiLCJjbGVhblZhbHVlIiwicmVwbGFjZSIsIm1hcCIsImwiLCJtZXNzYWdlIiwicmVzb2x2ZU1vZGVsTmFtZSIsImFwaUtleSIsIkdFTUlOSV9NT0RFTCIsInJlc3BvbnNlIiwiZmV0Y2giLCJkYXRhIiwianNvbiIsIm9rIiwiRXJyb3IiLCJzdGF0dXNUZXh0IiwibW9kZWxzIiwic3VwcG9ydGVkIiwiZmlsdGVyIiwibW9kZWwiLCJzdXBwb3J0ZWRHZW5lcmF0aW9uTWV0aG9kcyIsImluY2x1ZGVzIiwibmFtZSIsInByZWZlcnJlZCIsImZpbmQiLCJub3JtYWxpemVkIiwid2FybiIsImNvbmZpZyIsImFwaSIsImJvZHlQYXJzZXIiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmb3JtIiwibXVsdGlwbGVzIiwia2VlcEV4dGVuc2lvbnMiLCJtYXhGaWxlU2l6ZSIsInBhcnNlIiwiZXJyIiwiZmllbGRzIiwiZmlsZXMiLCJmaWxlIiwiQXJyYXkiLCJpc0FycmF5IiwiZmlsZXBhdGgiLCJmaWxlQnVmZmVyIiwiZXh0cmFjdGVkVGV4dCIsImZpbGVFeHRlbnNpb24iLCJleHRuYW1lIiwib3JpZ2luYWxGaWxlbmFtZSIsInRvTG93ZXJDYXNlIiwibWltZXR5cGUiLCJwZGZEYXRhIiwidGV4dCIsInBkZkVycm9yIiwiZG9jeERhdGEiLCJleHRyYWN0UmF3VGV4dCIsImJ1ZmZlciIsImRvY3hFcnJvciIsImdlbkFJIiwibW9kZWxOYW1lIiwiZ2V0R2VuZXJhdGl2ZU1vZGVsIiwicHJvbXB0IiwicmVzcG9uc2VUZXh0IiwicmVzdWx0IiwiZ2VuZXJhdGVDb250ZW50IiwibGlicmFyeUVycm9yIiwidjFSZXNwb25zZSIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbnRlbnRzIiwicGFydHMiLCJlcnJvckRhdGEiLCJ2MURhdGEiLCJjYW5kaWRhdGVzIiwidW5saW5rU3luYyIsImNsZWFudXBFcnJvciIsImFuYWx5c2lzIiwic3RhY2siXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/analyze.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fanalyze&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Canalyze.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();